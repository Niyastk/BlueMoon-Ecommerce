{% extends 'admin/adminBase.html' %}
{% load static %}

{% block content %}
<!-- Body: Body -->
<div class="body d-flex py-3">
  <div class="container-xxl">

    <div class="row align-items-center">
      <div class="border-0 mb-4">
        <div
          class="card-header py-3 no-bg bg-transparent d-flex align-items-center px-0 justify-content-between border-bottom flex-wrap">
          <h3 class="fw-bold mb-0">Products Add</h3>
        </div>
      </div>
    </div> <!-- Row end  -->
  </div>
  <div class="col-xl-12 col-lg-12">
    <div class="card mb-3">
      <div class="card-header py-3 d-flex justify-content-between bg-transparent border-bottom-0">
        <h6 class="mb-0 fw-bold ">Product information</h6>
      </div>
      {% for message in messages %}
      {% if "add_product_null" in message.tags %}
      <h6 style="color:red" class="ms-5 mt-3">{{message}}</h6>
      {% endif %}
      {% endfor %}
      <div class="card-body">
        <!-- form -->
        <form onsubmit=" return checkForm()" method="POST" action="{% url 'productAdd' %}"
          enctype="multipart/form-data">
          {% csrf_token %}
          <div class="row g-3 align-items-center">
            <div class="col-md-12">
              <label class="form-label">Name</label>
              <input onblur="checkName()" type="text" id="check_name" class="form-control" name="product_name">
              <p class="pl-2 " style="color: red;font-size:12px;font-style: italic;" id="display_name_error"></p>
            </div>
            <div class="col-md-4">
              <label class="form-label">MRP</label>
              <input onblur="checkMrp()" id="check_mrp" type="number" class="form-control" name="product_mrp">
              <p class="pl-2 " style="color: red;font-size:12px;font-style: italic;" id="display_mrp_error"></p>

            </div>
            <div class="col-md-4">
              <label class="form-label">Sale price</label>
              <input onblur="checkSalePrice()" id="check_sale_price" type="number" class="form-control"
                name="product_sale_price">
              <p class="pl-2 " style="color: red;font-size:12px;font-style: italic;" id="display_sale_price_error"></p>
            </div>
            <div class="col-md-4">
              <label class="form-label">Stock</label>
              <input onblur="checkStock()" id="check_stock" type="number" class="form-control" name="product_stock">
              <p class="pl-2 " style="color: red;font-size:12px;font-style: italic;" id="display_stock_error"></p>
            </div>
            <div class="col-md-12">
              <label class="form-label">Product Description</label>
              <input style="height:120px" type=" text" class="form-control" name="product_description">

            </div>
          </div>

          <div class="card mb-3 mt-3">
            <div
              class="card-header py-3 d-flex justify-content-between align-items-center bg-transparent border-bottom-0">
              <h6 class="m-0 fw-bold">Size</h6>
            </div>
            <div class="card-body">
              <div class="form-check">
                <input onchange="checkSize()" class="form-check-input" type="checkbox" id="sizechek2"
                  name="product_size_S">
                <label class="form-check-label" for="sizechek2">
                  S
                </label>
              </div>
              <div class="form-check">
                <input onchange="checkSize()" class="form-check-input" type="checkbox" id="sizechek3"
                  name="product_size_M">
                <label class="form-check-label" for="sizechek3">
                  M
                </label>
              </div>
              <div class="form-check">
                <input onchange="checkSize()" class="form-check-input" type="checkbox" id="sizechek4"
                  name="product_size_L">
                <label class="form-check-label" for="sizechek4">
                  L
                </label>
              </div>
              <div class="form-check">
                <input onchange="checkSize()" class="form-check-input" type="checkbox" id="sizechek5"
                  name="product_size_XL">
                <label class="form-check-label" for="sizechek5">
                  XL
                </label>
              </div>
              <p class="pl-2 " style="color: red;font-size:12px;font-style: italic;" id="display_size_error"></p>
            </div>
          </div>

          <div class="card mb-3 mt-3 ">
            <div
              class="card-header py-3 d-flex justify-content-between align-items-center bg-transparent border-bottom-0">
              <h6 class="m-0 fw-bold">Categories</h6>
            </div>
            <div class="card-body">
              <label class="form-label">Categories Select</label>
              <select onchange="categoryCheck()" id="category_check" class="form-select" size="3"
                aria-label="size 3 select example" name="product_category_id">
                {% for data in sub_category_data %}
                <option value="{{data.id}}"> {{ data.category_name }}</option>
                {% endfor %}
              </select>
              <p class="pl-2 " style="color: red;font-size:12px;font-style: italic;" id="display_category_error"></p>
            </div>
          </div>

          <div class="card mb-3">
            <div class="card-header py-3 d-flex justify-content-between bg-transparent border-bottom-0">
              <h6 class="mb-0 fw-bold ">Images</h6>
            </div>
            <div class="card-body">
              <div class="row g-3 align-items-center">
                <div class="col-md-12">
                  <label class="form-label">Product Images Upload</label>
                  <small class="d-block text-muted mb-2">Only portrait or square images.</small>
                  <small class="d-block text-muted mb-2">Product Image.</small>
                  <input onchange="fileValidation('product_image')" class="form-control" type="file" id="product_image"
                    class="dropify">
                  <textarea name="product_image" id="pro_img1" style="display: none;"></textarea>
                  <img src="" id="imageview1" style="height: auto;width: 100px;">

                  <!-- Gallery images -->
                  <small class="d-block text-muted mb-2 mt-3">Gallery images.</small>
                  <input onchange="fileValidation('product_gallery1')" class="form-control mt-2" type="file"
                    id="product_gallery1" class="dropify">
                  <textarea name="product_gallery1" id="pro_img2" style="display: none;"></textarea>
                  <img src="" id="imageview2" style="height: auto;width: 100px;">

                  <input onchange="fileValidation('product_gallery2')" class="form-control mt-2" type="file"
                    id="product_gallery2" class="dropify">
                  <textarea name="product_gallery2" id="pro_img3" style="display: none;"></textarea>
                  <img src="" id="imageview3" style="height: auto;width: 100px;">

                  <input onchange="fileValidation('product_gallery3')" class="form-control mt-2" type="file"
                    id="product_gallery3" class="dropify">
                  <textarea name="product_gallery3" id="pro_img4" style="display: none;"></textarea>
                  <img src="" id="imageview4" style="height: auto;width: 100px;">

                  <input onchange="fileValidation('product_gallery4')" class="form-control mt-2" type="file"
                    id="product_gallery4" class="dropify">
                  <textarea name="product_gallery4" id="pro_img5" style="display: none;"></textarea>
                  <img src="" id="imageview5" style="height: auto;width: 100px;">

                </div>
              </div>
            </div>
          </div>
          <button type="submit" id="submit_button"
            class="btn btn-primary btn-set-task w-sm-100 py-2 px-5 text-uppercase">Save</button>
        </form>

        <!-- form ends -->

      </div>
    </div>
    < </div>
  </div><!-- Row end  -->

</div>
</div>
</div>
</div>
<!-- MODAL 1 -->
<div class="modal fade" id="exampleModalCenter1" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Crop Image</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="result1"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close
        </button>
        <button type="button" id="btnCrop1" class="btn save1 btn-primary">Save changes
        </button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL 2 -->
<div class="modal fade" id="exampleModalCenter2" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Crop Image</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="result2"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close
        </button>
        <button type="button" id="btnCrop1" class="btn save2 btn-primary">Save changes
        </button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL 3 -->
<div class="modal fade" id="exampleModalCenter3" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Crop Image</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="result3"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close
        </button>
        <button type="button" id="btnCrop1" class="btn save3 btn-primary">Save changes
        </button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL 4 -->
<div class="modal fade" id="exampleModalCenter4" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Crop Image</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="result4"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close
        </button>
        <button type="button" id="btnCrop1" class="btn save4 btn-primary">Save changes
        </button>
      </div>
    </div>
  </div>
</div>

<!-- MODAL 5 -->
<div class="modal fade" id="exampleModalCenter5" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">Crop Image</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="result5"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close
        </button>
        <button type="button" id="btnCrop1" class="btn save5 btn-primary">Save changes
        </button>
      </div>
    </div>
  </div>
</div>

{% block additions %}


<!-- Jquery Plugin -->
<script src="{% static 'adminAssets/assets/js/ckeditor.js' %}"></script>
<script src="{% static 'adminAssets/assets/plugin/multi-select/js/jquery.multi-select.js' %}"></script>
<script src="{% static 'adminAssets/assets/plugin/bootstrap-tagsinput/bootstrap-tagsinput.js' %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/0.8.1/cropper.min.js"></script>
<!-- <script src="{% static 'adminAssets/assets/plugin/cropper/cropper.min.js' %}"></script> -->
<script src="{% static 'adminAssets/assets/plugin/cropper/cropper-init.js' %}"></script>
<script src="{% static 'adminAssets/assets/bundles/dropify.bundle.js' %}"></script>

<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>

  function fileValidation(id) {
    var fileInput = document.getElementById(id);
    var filePath = fileInput.value;
    // Allowing file type
    var allowedExtensions =
      /(\.jpg|\.jpeg|\.png)$/i;
    if (!allowedExtensions.exec(filePath)) {

      Swal.fire({
        title: 'Invalid Filetype',
        showClass: {
          popup: 'animate__animated animate__fadeInDown'
        },
        hideClass: {
          popup: 'animate__animated animate__fadeOutUp'

        }
      })
      fileInput.value = '';
      return false;
    } else {
      console.log("valid file type")
    }

  }




  //cropping 

  let result1 = document.querySelector('.result1'),
    save1 = document.querySelector('.save1'),
    cropped1 = document.querySelector('.imageview1'),
    upload1 = document.querySelector('#product_image'),
    cropper1 = '';

  upload1.addEventListener('change', (e) => {
    var fileName = document.getElementById("product_image").value;
    var idxDot = fileName.lastIndexOf(".") + 1;
    var extFile = fileName.substr(idxDot, fileName.length).toLowerCase();
    if (extFile == "jpg" || extFile == "jpeg" || extFile == "png") {
      if (e.target.files.length) {
        // start file reader
        const reader = new FileReader();
        reader.onload = (e) => {
          if (e.target.result) {
            // create new image
            $("#exampleModalCenter1").modal("show");
            let img1 = document.createElement('img');
            img1.id = 'image1';
            img1.src = e.target.result;
            // clean result before
            result1.innerHTML = '';
            // append new image
            result1.appendChild(img1);
            // init cropper
            cropper1 = new Cropper(img1, {
              aspectRatio: 8 / 6,
              viewMode: 1,
            });
          }
        };
        reader.readAsDataURL(e.target.files[0]);
      }
    } else {
      swal("this file type is not supported", {
        icon: "error",
      })
      fileName = "";
      console.log(fileName)
    }
  });

  save1.addEventListener('click', (e) => {
    e.preventDefault();
    // get result to data uri
    let imgSrc1 = cropper1.getCroppedCanvas({
      width: 800,
      height: 600 // img display value
    }).toDataURL();
    $("#exampleModalCenter1").modal("hide");
    imageview1.src = imgSrc1;
    $('#pro_img1').val(imgSrc1)

  });

  $(document).ready(function () {
    //Ch-editer
    ClassicEditor
      .create(document.querySelector('#editor'))
      .catch(error => {
        console.error(error);
      });
    //Datatable

    $('.deleterow').on('click', function () {
      var tablename = $(this).closest('table').DataTable();
      tablename
        .row($(this)
          .parents('tr'))
        .remove()
        .draw();

    });
    //Multiselect
    $('#optgroup').multiSelect({ selectableOptgroup: true });
  });

  $(function () {
    $('.dropify').dropify();

    var drEvent = $('#dropify-event').dropify();
    drEvent.on('dropify.beforeClear', function (event, element) {
      return confirm("Do you really want to delete \"" + element.file.name + "\" ?");
    });

    drEvent.on('dropify.afterClear', function (event, element) {
      alert('File deleted');
    });

    $('.dropify-fr').dropify({
      messages: {
        default: 'Glissez-dÃ©posez un fichier ici ou cliquez',
        replace: 'Glissez-dÃ©posez un fichier ou cliquez pour remplacer',
        remove: 'Supprimer',
        error: 'DÃ©solÃ©, le fichier trop volumineux'
      }
    });
  });

  //validations

  function checkName() {

    var name = document.getElementById('check_name').value;

    if (name == "") {
      document.getElementById('display_name_error').style.display = "block";
      document.getElementById('display_name_error').innerHTML = "Please enter the name";
      console.log("name check not")
      return false;
    } else {
      document.getElementById('display_name_error').style.display = "none";
      console.log("name check")
      return true;
    }
  }
  function checkMrp() {

    var name = document.getElementById('check_mrp').value;

    if (name == "") {
      document.getElementById('display_mrp_error').style.display = "block";
      document.getElementById('display_mrp_error').innerHTML = "Please enter the MRP";
      console.log("mrp check not")
      return false;
    } else if (name < 0) {
      document.getElementById('display_mrp_error').style.display = "block";
      document.getElementById('display_mrp_error').innerHTML = "Please enter a positive Value";
      console.log("mrp check not")
      return false;
    } else {
      document.getElementById('display_mrp_error').style.display = "none";
      console.log("mrp check")
      return true;
    }
  }
  function checkSalePrice() {

    var name = document.getElementById('check_sale_price').value;

    if (name == "") {
      document.getElementById('display_sale_price_error').style.display = "block";
      document.getElementById('display_sale_price_error').innerHTML = "Please enter the sale price";
      console.log("sp check not")
      return false;
    } else if (name < 0) {
      document.getElementById('display_sale_price_error').style.display = "block";
      document.getElementById('display_sale_price_error').innerHTML = "Please enter a positive Value";
      console.log("sp check not")
      return false;
    } else {
      document.getElementById('display_sale_price_error').style.display = "none";
      console.log("sp check")
      return true;
    }
  }
  function checkStock() {

    var name = document.getElementById('check_stock').value;

    if (name == "") {
      document.getElementById('display_stock_error').style.display = "block";
      document.getElementById('display_stock_error').innerHTML = "Please enter the stock quantity";
      console.log("stock check not")
      return false;
    } else if (name < 0) {
      document.getElementById('display_stock_error').style.display = "block";
      document.getElementById('display_stock_error').innerHTML = "Please enter a positive Value";
      console.log("stock check not")
      return false;
    } else {
      document.getElementById('display_stock_error').style.display = "none";
      console.log("stock check")
      return true;
    }
  }
  function checkSize() {

    const checkbox1 = document.getElementById('sizechek2');
    const checkbox2 = document.getElementById('sizechek3');
    const checkbox3 = document.getElementById('sizechek4');
    const checkbox4 = document.getElementById('sizechek5');
    if (checkbox1.checked || checkbox2.checked || checkbox3.checked || checkbox4.checked) {
      document.getElementById('display_size_error').style.display = "none";
      console.log("size check")
      return true;
    } else {
      document.getElementById('display_size_error').style.display = "block";
      document.getElementById('display_size_error').innerHTML = "Please Select one Size";
      console.log("size check not")
      return false;
    }
  }

  function categoryCheck() {

    var category = document.getElementById('category_check');
    if (category.selectedIndex == -1) {
      document.getElementById('display_category_error').style.display = "block";
      document.getElementById('display_category_error').innerHTML = "Please Select one Category";
      console.log("cat check not")
      return false;
    } else {
      document.getElementById('display_category_error').style.display = "none";
      console.log("cat check")
      return true;
    }
  }
  function checkPhoto() {

    var image = document.getElementById('product_image').value;
    console.log(image.length)
    if (image == 0) {

      document.getElementById('display_photo_error').style.display = "block";
      document.getElementById('display_photo_error').innerHTML = "Please enter the name";
      console.log("photo check not")
      return false;
    } else {
      document.getElementById('display_photo_error').style.display = "none";
      console.log("photo check")
      return true;

    }
  }


  function checkForm() {
    console.log("checking form")

    if (checkName() && checkMrp() && checkSalePrice() && checkStock()
      && checkSize() && categoryCheck() && checkPhoto()) {
      return true;
    } else {
      checkName()
      checkMrp()
      checkSalePrice()
      checkStock()
      checkSize()
      categoryCheck()

      Swal.fire({
        icon: 'error',
        title: 'Oops...',
        text: 'Please fill all the fields including image!',
      })
      return false;

    }
  }

</script>

<script>
  let result2 = document.querySelector('.result2'),
    save2 = document.querySelector('.save2'),
    cropped2 = document.querySelector('.imageview2'),
    upload2 = document.querySelector('#product_gallery1'),
    cropper2 = '';

  upload2.addEventListener('change', (e) => {
    var fileName = document.getElementById("product_gallery1").value;
    var idxDot = fileName.lastIndexOf(".") + 1;
    var extFile = fileName.substr(idxDot, fileName.length).toLowerCase();
    if (extFile == "jpg" || extFile == "jpeg" || extFile == "png") {
      if (e.target.files.length) {
        // start file reader
        const reader = new FileReader();
        reader.onload = (e) => {
          if (e.target.result) {
            // create new image
            $("#exampleModalCenter2").modal("show");
            let img2 = document.createElement('img');
            img2.id = 'image2';
            img2.src = e.target.result;
            // clean result before
            result2.innerHTML = '';
            // append new image
            result2.appendChild(img2);
            // init cropper
            cropper2 = new Cropper(img2, {
              aspectRatio: 8 / 6,
              viewMode: 1,
            });
          }
        };
        reader.readAsDataURL(e.target.files[0]);
      }
    } else {
      swal("this file type is not supported", {
        icon: "error",
      })
      fileName = "";
      console.log(fileName)
    }
  });

  save2.addEventListener('click', (e) => {
    e.preventDefault();
    // get result to data uri
    let imgSrc2 = cropper2.getCroppedCanvas({
      width: 800,
      height: 600 // img disp value
    }).toDataURL();
    $("#exampleModalCenter2").modal("hide");
    imageview2.src = imgSrc2;
    $('#pro_img2').val(imgSrc2)

  });


</script>

<script>
  let result3 = document.querySelector('.result3'),
    save3 = document.querySelector('.save3'),
    cropped3 = document.querySelector('.imageview3'),
    upload3 = document.querySelector('#product_gallery2'),
    cropper3 = '';

  upload3.addEventListener('change', (e) => {
    var fileName = document.getElementById("product_gallery2").value;
    var idxDot = fileName.lastIndexOf(".") + 1;
    var extFile = fileName.substr(idxDot, fileName.length).toLowerCase();
    if (extFile == "jpg" || extFile == "jpeg" || extFile == "png") {
      if (e.target.files.length) {
        // start file reader
        const reader = new FileReader();
        reader.onload = (e) => {
          if (e.target.result) {
            // create new image
            $("#exampleModalCenter3").modal("show");
            let img3 = document.createElement('img');
            img3.id = 'image3';
            img3.src = e.target.result;
            // clean result before
            result3.innerHTML = '';
            // append new image
            result3.appendChild(img3);
            // init cropper
            cropper3 = new Cropper(img3, {
              aspectRatio: 8 / 6,
              viewMode: 1,
            });
          }
        };
        reader.readAsDataURL(e.target.files[0]);
      }
    } else {
      swal("this file type is not supported", {
        icon: "error",
      })
      fileName = "";
      console.log(fileName)
    }
  });

  save3.addEventListener('click', (e) => {
    e.preventDefault();
    // get result to data uri
    let imgSrc3 = cropper3.getCroppedCanvas({
      width: 800,
      height: 600 // img disp value
    }).toDataURL();
    $("#exampleModalCenter3").modal("hide");
    imageview3.src = imgSrc3;
    $('#pro_img3').val(imgSrc3)

  });


</script>

<script>
  let result4 = document.querySelector('.result4'),
    save4 = document.querySelector('.save4'),
    cropped4 = document.querySelector('.imageview4'),
    upload4 = document.querySelector('#product_gallery3'),
    cropper4 = '';

  upload4.addEventListener('change', (e) => {
    var fileName = document.getElementById("product_gallery3").value;
    var idxDot = fileName.lastIndexOf(".") + 1;
    var extFile = fileName.substr(idxDot, fileName.length).toLowerCase();
    if (extFile == "jpg" || extFile == "jpeg" || extFile == "png") {
      if (e.target.files.length) {
        // start file reader
        const reader = new FileReader();
        reader.onload = (e) => {
          if (e.target.result) {
            // create new image
            $("#exampleModalCenter4").modal("show");
            let img4 = document.createElement('img');
            img4.id = 'image4';
            img4.src = e.target.result;
            // clean result before
            result4.innerHTML = '';
            // append new image
            result4.appendChild(img4);
            // init cropper
            cropper4 = new Cropper(img4, {
              aspectRatio: 8 / 6,
              viewMode: 1,
            });
          }
        };
        reader.readAsDataURL(e.target.files[0]);
      }
    } else {
      swal("this file type is not supported", {
        icon: "error",
      })
      fileName = "";
      console.log(fileName)
    }
  });

  save4.addEventListener('click', (e) => {
    e.preventDefault();
    // get result to data uri
    let imgSrc4 = cropper4.getCroppedCanvas({
      width: 800,
      height: 600 // img disp value
    }).toDataURL();
    $("#exampleModalCenter4").modal("hide");
    imageview4.src = imgSrc4;
    $('#pro_img4').val(imgSrc4)

  });


</script>

<script>
  let result5 = document.querySelector('.result5'),
    save5 = document.querySelector('.save5'),
    cropped5 = document.querySelector('.imageview5'),
    upload5 = document.querySelector('#product_gallery4'),
    cropper5 = '';

  upload5.addEventListener('change', (e) => {
    var fileName = document.getElementById("product_gallery4").value;
    var idxDot = fileName.lastIndexOf(".") + 1;
    var extFile = fileName.substr(idxDot, fileName.length).toLowerCase();
    if (extFile == "jpg" || extFile == "jpeg" || extFile == "png") {
      if (e.target.files.length) {
        // start file reader
        const reader = new FileReader();
        reader.onload = (e) => {
          if (e.target.result) {
            // create new image
            $("#exampleModalCenter5").modal("show");
            let img5 = document.createElement('img');
            img5.id = 'image5';
            img5.src = e.target.result;
            // clean result before
            result5.innerHTML = '';
            // append new image
            result5.appendChild(img5);
            // init cropper
            cropper5 = new Cropper(img5, {
              aspectRatio: 8 / 6,
              viewMode: 1,
            });
          }
        };
        reader.readAsDataURL(e.target.files[0]);
      }
    } else {
      swal("this file type is not supported", {
        icon: "error",
      })
      fileName = "";
      console.log(fileName)
    }
  });

  save5.addEventListener('click', (e) => {
    e.preventDefault();
    // get result to data uri
    let imgSrc5 = cropper5.getCroppedCanvas({
      width: 800,
      height: 600 // img disp value
    }).toDataURL();
    $("#exampleModalCenter5").modal("hide");
    imageview5.src = imgSrc5;
    $('#pro_img5').val(imgSrc5)

  });


</script>
{% endblock %}
{% endblock %}